{
  // See https://go.microsoft.com/fwlink/?LinkId=733558
  // for the documentation about the tasks.json format
  "version": "2.0.0",
  "tasks": [
    {
      "type": "shell",
      "command": "cargo",
      "args": ["build", "--release"],
      "label": "Build (release)"
    },
    {
      "type": "shell",
      "command": "cargo",
      "args": ["build"],
      "label": "Build (debug)"
    },

    {
      "label": "Relative Gap (grid)",
      "type": "shell",
      "command": "sumo-relative-gap-calculator",
      "dependsOn": ["Build (debug)"],
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo/grid",
        "env": {
          "PATH": "${workspaceFolder}:${workspaceFolder}/lib/InertialFlowCutter/build:${workspaceFolder}/target/debug/:${env:PATH}"
        }
      },
      "args": [
        "--net-dir",
        "${workspaceFolder}/import/sumo/grid",
        "--net-prefix",
        "grid",
        "--trips-file",
        "${workspaceFolder}/import/sumo/grid/grid.trips.xml"
      ]
    },
    {
      "label": "Compare Routes (grid)",
      "type": "shell",
      "command": "sumo-routes-comparator",
      "dependsOn": ["Build (debug)"],
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo/grid-dijkstra",
        "env": {
          "PATH": "${workspaceFolder}:${workspaceFolder}/lib/InertialFlowCutter/build:${workspaceFolder}/target/debug/:${env:PATH}"
        }
      },
      "args": [
        "--net-dir",
        "${workspaceFolder}/import/sumo/grid",
        "--net-prefix",
        "grid",
        "--trips-file",
        "${workspaceFolder}/import/sumo/grid/grid.trips.xml"
      ]
    },
    {
      "label": "Run DTA (grid)",
      "type": "shell",
      "command": "python",
      "dependsOn": [
        "Build (debug)",
        "Copy duaIterate.py to SUMO",
        "Clean grid"
      ],
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo/grid",
        "env": {
          "PATH": "${workspaceFolder}:${workspaceFolder}/lib/InertialFlowCutter/build:${workspaceFolder}/target/debug/:${workspaceFolder}/lib/libsumo/bin/:${env:PATH}",
          "RUST_BACKTRACE": "1"
        }
      },
      "args": [
        "${workspaceFolder}/lib/libsumo/lib/python3.12/site-packages/sumo/tools/assign/duaIterate.py",
        "-n",
        "${workspaceFolder}/import/sumo/grid/grid.net.xml",
        "-t",
        "${workspaceFolder}/import/sumo/grid/grid.trips.xml",
        "--routing-algorithm",
        "CCH",
        "--mesosim",
        "--aggregation",
        "300",
        "--begin",
        "0",
        "--end",
        "12000",
        "--relative-gap",
        "0.0001",
        "--max-convergence-deviation",
        "0.0000001",
        "sumo--default.speeddev",
        "0.0",
        "cch-preprocessor--input-prefix",
        "grid",
        "cch-preprocessor--input-dir",
        "${workspaceFolder}/import/sumo/grid",
        "relative-gap--net-prefix",
        "grid",
        "relative-gap--net-dir",
        "${workspaceFolder}/import/sumo/grid"
      ]
    },
    {
      "label": "Run DTA (grid; CH)",
      "type": "shell",
      "command": "python",
      "dependsOn": [
        "Build (debug)",
        "Copy duaIterate.py to SUMO",
        "Clean grid-ch"
      ],
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo/grid-ch",
        "env": {
          "PATH": "${workspaceFolder}:${workspaceFolder}/lib/InertialFlowCutter/build:${workspaceFolder}/target/debug/:${workspaceFolder}/lib/libsumo/bin/:${env:PATH}"
        }
      },
      "args": [
        "${workspaceFolder}/lib/libsumo/lib/python3.12/site-packages/sumo/tools/assign/duaIterate.py",
        "-n",
        "${workspaceFolder}/import/sumo/grid/grid.net.xml",
        "-t",
        "${workspaceFolder}/import/sumo/grid/grid.trips.xml",
        "--routing-algorithm",
        "CH",
        "--mesosim",
        "--aggregation",
        "300",
        "--begin",
        "0",
        "--end",
        "12000",
        "--relative-gap",
        "0.0001",
        "--max-convergence-deviation",
        "0.0000001",
        "sumo--default.speeddev",
        "0.0",
        "relative-gap--net-prefix",
        "grid",
        "relative-gap--net-dir",
        "${workspaceFolder}/import/sumo/grid"
      ]
    },
    {
      "label": "Run DTA (grid; dijkstra)",
      "type": "shell",
      "command": "python",
      "dependsOn": [
        "Copy duaIterate.py to SUMO",
        "Clean grid-dijkstra",
        "Build (debug)"
      ],
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo/grid-dijkstra",
        "env": {
          "PATH": "${workspaceFolder}:${workspaceFolder}/lib/InertialFlowCutter/build:${workspaceFolder}/target/debug/:${workspaceFolder}/lib/libsumo/bin/:${env:PATH}",
          "RUST_BACKTRACE": "1"
        }
      },
      "args": [
        "${workspaceFolder}/lib/libsumo/lib/python3.12/site-packages/sumo/tools/assign/duaIterate.py",
        "-n",
        "${workspaceFolder}/import/sumo/grid/grid.net.xml",
        "-t",
        "${workspaceFolder}/import/sumo/grid/grid.trips.xml",
        "--routing-algorithm",
        "dijkstra",
        "--mesosim",
        "--aggregation",
        "300",
        "--begin",
        "0",
        "--end",
        "12000",
        "--relative-gap",
        "0.0001",
        "--max-convergence-deviation",
        "0.0000001",
        "sumo--default.speeddev",
        "0.0",
        "relative-gap--net-prefix",
        "grid",
        "relative-gap--net-dir",
        "${workspaceFolder}/import/sumo/grid"
      ]
    },
    {
      "label": "Run DTA (grid; dijkstra-rust)",
      "type": "shell",
      "command": "python",
      "dependsOn": [
        "Copy duaIterate.py to SUMO",
        "Clean grid-dijkstra-rust",
        "Build (debug)"
      ],
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo/grid-dijkstra-rust",
        "env": {
          "PATH": "${workspaceFolder}:${workspaceFolder}/lib/InertialFlowCutter/build:${workspaceFolder}/target/debug/:${workspaceFolder}/lib/libsumo/bin/:${env:PATH}",
          "RUST_BACKTRACE": "1"
        }
      },
      "args": [
        "${workspaceFolder}/lib/libsumo/lib/python3.12/site-packages/sumo/tools/assign/duaIterate.py",
        "-n",
        "${workspaceFolder}/import/sumo/grid/grid.net.xml",
        "-t",
        "${workspaceFolder}/import/sumo/grid/grid.trips.xml",
        "--routing-algorithm",
        "dijkstra-rust",
        "--mesosim",
        "--aggregation",
        "300",
        "--begin",
        "0",
        "--end",
        "12000",
        "--relative-gap",
        "0.0001",
        "--max-convergence-deviation",
        "0.0000001",
        "sumo--default.speeddev",
        "0.0",
        "dijkstra-preprocessor--input-prefix",
        "grid",
        "dijkstra-preprocessor--input-dir",
        "${workspaceFolder}/import/sumo/grid",
        "relative-gap--net-prefix",
        "grid",
        "relative-gap--net-dir",
        "${workspaceFolder}/import/sumo/grid"
      ]
    },
    {
      "label": "Run DTA (suboptimal routing)",
      "type": "shell",
      "dependsOn": [
        "Build (debug)",
        "Copy duaIterate.py to SUMO",
        "Clean example data"
      ],
      "command": "python",
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo/example-data",
        "env": {
          "PATH": "${workspaceFolder}:${workspaceFolder}/lib/InertialFlowCutter/build:${workspaceFolder}/target/debug/:${workspaceFolder}/lib/libsumo/bin/:${env:PATH}"
        }
      },
      "args": [
        "${workspaceFolder}/lib/libsumo/lib/python3.12/site-packages/sumo/tools/assign/duaIterate.py",
        "-n",
        "${workspaceFolder}/import/sumo/suboptimal-routing/suboptimal-routing.net.xml",
        "-t",
        "${workspaceFolder}/import/sumo/suboptimal-routing/suboptimal-routing.trips.xml",
        "--routing-algorithm",
        "CCH",
        "--mesosim",
        "--aggregation",
        "900",
        "--begin",
        "0",
        "--end",
        "36000",
        "-f",
        "0",
        "-l",
        "2",
        "cch-preprocessor--input-prefix",
        "suboptimal-routing",
        "cch-preprocessor--input-dir",
        "${workspaceFolder}/import/sumo/suboptimal-routing"
      ]
    },
    {
      "label": "Run DTA (suboptimal routing - sumo)",
      "type": "shell",
      "dependsOn": ["Build (debug)", "Copy duaIterate.py to SUMO"],
      "command": "python",
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo/example-data",
        "env": {
          "PATH": "${workspaceFolder}:${workspaceFolder}/lib/InertialFlowCutter/build:${workspaceFolder}/target/debug/:${workspaceFolder}/lib/libsumo/bin/:${env:PATH}"
        }
      },
      "args": [
        "${workspaceFolder}/lib/libsumo/lib/python3.12/site-packages/sumo/tools/assign/duaIterate.py",
        "-n",
        "${workspaceFolder}/import/sumo/suboptimal-routing/suboptimal-routing.net.xml",
        "-t",
        "${workspaceFolder}/import/sumo/suboptimal-routing/suboptimal-routing.trips.xml",
        "--routing-algorithm",
        "dijkstra",
        "--mesosim",
        "--aggregation",
        "900",
        "--begin",
        "0",
        "--end",
        "36000",
        "-f",
        "1",
        "-l",
        "2"
      ]
    },
    {
      "label": "Clean grid",
      "type": "shell",
      "command": "rm",
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo"
      },
      "args": ["-rf", "grid/*"],
      "hide": true
    },

    {
      "label": "Clean grid-ch",
      "type": "shell",
      "command": "rm",
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo"
      },
      "args": ["-rf", "grid-ch/*"],
      "hide": true
    },
    {
      "label": "Clean grid-dijkstra",
      "type": "shell",
      "command": "rm",
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo"
      },
      "args": ["-rf", "grid-dijkstra/*"],
      "hide": true
    },
    {
      "label": "Clean grid-dijkstra-rust",
      "type": "shell",
      "command": "rm",
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo"
      },
      "args": ["-rf", "grid-dijkstra-rust/*"],
      "hide": true
    },
    {
      "label": "Clean example data",
      "type": "shell",
      "command": "rm",
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo"
      },
      "args": ["-rf", "example-data/*"],
      "hide": true
    },
    {
      "label": "Clean karlsruhe",
      "type": "shell",
      "command": "rm",
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo"
      },
      "args": ["-rf", "karlsruhe/*"],
      "hide": true
    },
    {
      "label": "Clean kelheim",
      "type": "shell",
      "command": "rm",
      "options": {
        "cwd": "${workspaceFolder}/data/imported/sumo"
      },
      "args": ["-rf", "kelheim/*"],
      "hide": true
    },
    {
      "label": "Copy duaIterate.py to SUMO",
      "type": "shell",
      "command": "cp",
      "options": {
        "cwd": "${workspaceFolder}/"
      },
      "args": [
        "fastdta/duaIterate.py",
        "lib/libsumo/lib/python3.12/site-packages/sumo/tools/assign/duaIterate.py"
      ],
      "hide": true
    },
    {
      "label": "Preprocess (example data)",
      "type": "shell",
      "command": "cargo",
      "args": [
        "run",
        "--package",
        "fastdta",
        "--bin",
        "sumo-tdcch-preprocessor",
        "--",
        "--input-dir",
        "${workspaceFolder}/import/sumo/example-data",
        "--input-prefix",
        "example-data",
        "--trips-file",
        "${workspaceFolder}/import/sumo/example-data/example-data.trips.xml",
        "--output-dir",
        "${workspaceFolder}/data/imported/sumo/example-data"
      ],
      "options": {
        "env": {
          "PATH": "${workspaceFolder}:${workspaceFolder}/lib/InertialFlowCutter/build:${workspaceFolder}/target/debug/:${workspaceFolder}/lib/libsumo/bin/:${env:PATH}"
        }
      },
      "hide": true,
      "dependsOn": ["Build (debug)", "Copy duaIterate.py to SUMO"]
    }
  ]
}
